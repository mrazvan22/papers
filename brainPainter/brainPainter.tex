%% 
%% Copyright 2007, 2008, 2009 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for Elsevier's document class `elsarticle'
%% with harvard style bibliographic references
%% SP 2008/03/01

%\documentclass[preprint,12pt,authoryear]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times,authoryear]{elsarticle}
%\documentclass[final,1p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,3p,times,authoryear]{elsarticle}
%\documentclass[final,3p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,5p,times,authoryear]{elsarticle}

\documentclass[final,times,twocolumn,authoryear]{elsarticle}
\usepackage[margin=2cm]{geometry}% by courtesy of Mico
            
%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
\usepackage{array}
% \usepackage{biblatex}


\usepackage{listings}

\usepackage{graphicx}
\usepackage{placeins}

\usepackage{xpatch}
\usepackage[font=normalfont]{subfig}
% \usepackage{subcaption}

\usepackage{etoolbox,lipsum}
\makeatletter
\patchcmd\@maketitle\@author{\@author \\[\normalbaselineskip] \myfigure}{}{}
\newcommand\myfigure{%
  \makebox[0pt]{
 \includegraphics[height=3cm]{images/cortical-front_0.png}
 \includegraphics[height=3cm]{images/cortical-back_0.png}
 \includegraphics[height=3cm]{images/subcortical_0.png}
} \\[\normalbaselineskip]
  \refstepcounter{figure}\normalfont\textbf{Figure~\thefigure: Some stuff about the teaser}
  \label{fig-teaser}
}
\makeatother


\usepackage[font=normalfont,labelfont=bf]{caption}


\makeatletter\ifdefined\Hy@StartlinkName
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \addOneNestingLevelStartLink
% \addOneNestingLevelEndLink
%
% put ONE of \addOneNestingLevel(Start|End)Link in front of offending \cite
% depending on the placement of the double-column float object
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\addOneNestingLevelStartLink{%
  \gdef\Hy@StartlinkName##1##2{%
    \sbox0{\Hy@StartlinkNameOrig{##1}{##2}}\usebox0
    \global\let\Hy@StartlinkName\Hy@StartlinkNameOrig%
  }%
}
\def\addOneNestingLevelEndLink{%
  \gdef\pdfendlink{%
    \sbox0{\pdfendlinkOrig}\usebox0%
    \global\let\pdfendlink\pdfendlinkOrig%
  }%
}
\let\Hy@StartlinkNameOrig\Hy@StartlinkName
\let\pdfendlinkOrig\pdfendlink
\else
\let\addOneNestingLevelStartLink\relax
\let\addOneNestingLevelEndLink\relax
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatother


%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}



\usepackage{etoolbox}
% \patchcmd{<cmd>}{<search>}{<replace>}{<success>}{<failure>}
\patchcmd{\emailauthor}{(#2)}{}{}{}
\patchcmd{\urlauthor}{(#2)}{}{}{}

\journal{}

\makeatletter
\def\ps@pprintTitle{%
 \let\@oddhead\@empty
 \let\@evenhead\@empty
 \def\@oddfoot{}%
 \let\@evenfoot\@oddfoot
 }
\makeatother

\usepackage{xcolor}


\usepackage{hyperref}
\definecolor{links}{HTML}{01368e}
% \hypersetup{colorlinks,linkcolor=links,urlcolor=links}

\makeatletter
\hypersetup{colorlinks=true}
\AtBeginDocument{\@ifpackageloaded{hyperref}
  {\def\@linkcolor{links}
   \def\@anchorcolor{links}
   \def\@citecolor{links}
   \def\@filecolor{links}
   \def\@urlcolor{links}
   \def\@menucolor{links}
   \def\@pagecolor{links}
\begingroup
  \@makeother\`%
  \@makeother\=%
  \edef\x{%
    \edef\noexpand\x{%
      \endgroup
      \noexpand\toks@{%
        \catcode 96=\noexpand\the\catcode`\noexpand\`\relax
        \catcode 61=\noexpand\the\catcode`\noexpand\=\relax
      }%
    }%
    \noexpand\x
  }%
\x
\@makeother\`
\@makeother\=
}{}}
\makeatother

\usepackage{tikz}


\usepackage{filecontents}

\begin{filecontents*}{bibliography.bib}
@article{jack2010hypothetical,
  title={Hypothetical model of dynamic biomarkers of the {Alzheimer}'s pathological cascade},
  author={Jack Jr, Clifford R and Knopman, David S and Jagust, William J and Shaw, Leslie M and Aisen, Paul S and Weiner, Michael W and Petersen, Ronald C and Trojanowski, John Q},
  journal={The Lancet Neurology},
  volume={9},
  number={1},
  pages={119--128},
  year={2010},
  publisher={Elsevier}
}
@article{scahill2002mapping,
  title={Mapping the evolution of regional atrophy in {Alzheimer}'s disease: unbiased analysis of fluid-registered serial MRI},
  author={Scahill, Rachael I and Schott, Jonathan M and Stevens, John M and Rossor, Martin N and Fox, Nick C},
  journal={Proceedings of the National Academy of Sciences},
  volume={99},
  number={7},
  pages={4703--4707},
  year={2002},
  publisher={National Acad Sciences}
}
@article{migliaccio2015mapping,
  title={Mapping the progression of atrophy in early-and late-onset Alzheimerâ€™s disease},
  author={Migliaccio, Raffaella and Agosta, Federica and Possin, Katherine L and Canu, Elisa and Filippi, Massimo and Rabinovici, Gil D and Rosen, Howard J and Miller, Bruce L and Gorno-Tempini, Maria Luisa},
  journal={Journal of Alzheimer's Disease},
  volume={46},
  number={2},
  pages={351--364},
  year={2015},
  publisher={IOS Press}
}
@article{chard2002brain,
  title={Brain atrophy in clinically early relapsing--remitting multiple sclerosis},
  author={Chard, DT and Griffin, CM and Parker, GJM and Kapoor, R and Thompson, AJ and Miller, DH},
  journal={Brain},
  volume={125},
  number={2},
  pages={327--337},
  year={2002},
  publisher={Oxford University Press}
}
@article{schoonheim2012subcortical,
  title={Subcortical atrophy and cognition: sex effects in multiple sclerosis},
  author={Schoonheim, Menno M and Popescu, Veronica and Lopes, Fernanda C Rueda and Wiebenga, Oliver T and Vrenken, Hugo and Douw, Linda and Polman, Chris H and Geurts, Jeroen JG and Barkhof, Frederik},
  journal={Neurology},
  volume={79},
  number={17},
  pages={1754--1761},
  year={2012},
  publisher={AAN Enterprises}
}
@article{coughlin2015neuroinflammation,
  title={Neuroinflammation and brain atrophy in former {NFL} players: an in vivo multimodal imaging pilot study},
  author={Coughlin, Jennifer M and Wang, Yuchuan and Munro, Cynthia A and Ma, Shuangchao and Yue, Chen and Chen, Shaojie and Airan, Raag and Kim, Pearl K and Adams, Ashley V and Garcia, Cinthya and others},
  journal={Neurobiology of disease},
  volume={74},
  pages={58--65},
  year={2015},
  publisher={Elsevier}
}
@inproceedings{pieper20043d,
  title={3D Slicer},
  author={Pieper, Steve and Halle, Michael and Kikinis, Ron},
  booktitle={2004 2nd IEEE international symposium on biomedical imaging: nano to macro (IEEE Cat No. 04EX821)},
  pages={632--635},
  year={2004},
  organization={IEEE}
}
@article{fischl2012freesurfer,
  title={FreeSurfer},
  author={Fischl, Bruce},
  journal={Neuroimage},
  volume={62},
  number={2},
  pages={774--781},
  year={2012},
  publisher={Elsevier}
}
@book{penny2011statistical,
  title={Statistical parametric mapping: the analysis of functional brain images},
  author={Penny, William D and Friston, Karl J and Ashburner, John T and Kiebel, Stefan J and Nichols, Thomas E},
  year={2011},
  publisher={Elsevier}
}
@article{desikan2006automated,
  title={An automated labeling system for subdividing the human cerebral cortex on {MRI} scans into gyral based regions of interest},
  author={Desikan, Rahul S and S{\'e}gonne, Florent and Fischl, Bruce and Quinn, Brian T and Dickerson, Bradford C and Blacker, Deborah and Buckner, Randy L and Dale, Anders M and Maguire, R Paul and Hyman, Bradley T and others},
  journal={Neuroimage},
  volume={31},
  number={3},
  pages={968--980},
  year={2006},
  publisher={Elsevier}
}
@article{destrieux2010automatic,
  title={Automatic parcellation of human cortical gyri and sulci using standard anatomical nomenclature},
  author={Destrieux, Christophe and Fischl, Bruce and Dale, Anders and Halgren, Eric},
  journal={Neuroimage},
  volume={53},
  number={1},
  pages={1--15},
  year={2010},
  publisher={Elsevier}
}
@article{young2018uncovering,
  title={Uncovering the heterogeneity and temporal complexity of neurodegenerative diseases with {Subtype} and {Stage} {Inference}},
  author={Young, Alexandra L and Marinescu, Razvan V and Oxtoby, Neil P and Bocchetta, Martina and Yong, Keir and Firth, Nicholas C and Cash, David M and Thomas, David L and Dick, Katrina M and Cardoso, Jorge and others},
  journal={Nature communications},
  volume={9},
  number={1},
  pages={4273},
  year={2018},
  publisher={Nature Publishing Group}
}
@article{wijeratne2018image,
  title={An image-based model of brain volume biomarker changes in {Huntington}'s disease},
  author={Wijeratne, Peter A and Young, Alexandra L and Oxtoby, Neil P and Marinescu, Razvan V and Firth, Nicholas C and Johnson, Eileanoir B and Mohan, Amrita and Sampaio, Cristina and Scahill, Rachael I and Tabrizi, Sarah J and others},
  journal={Annals of clinical and translational neurology},
  volume={5},
  number={5},
  pages={570--582},
  year={2018},
  publisher={Wiley Online Library}
}
@article{douaud2009vivo,
  title={In vivo evidence for the selective subcortical degeneration in {Huntington}'s disease},
  author={Douaud, Gwena{\"e}lle and Behrens, Timothy E and Poupon, Cyril and Cointepas, Yann and Jbabdi, Sa{\^a}d and Gaura, V{\'e}ronique and Golestani, Narly and Krystkowiak, Pierre and Verny, Christophe and Damier, Philippe and others},
  journal={Neuroimage},
  volume={46},
  number={4},
  pages={958--966},
  year={2009},
  publisher={Elsevier}
}
@article{mudher2002alzheimer,
  title={Alzheimer's disease--do tauists and baptists finally shake hands?},
  author={Mudher, Amritpal and Lovestone, Simon},
  journal={Trends in neurosciences},
  volume={25},
  number={1},
  pages={22--26},
  year={2002},
  publisher={Elsevier}
}
@article{klein2012101,
  title={101 labeled brain images and a consistent human cortical labeling protocol},
  author={Klein, Arno and Tourville, Jason},
  journal={Frontiers in neuroscience},
  volume={6},
  pages={171},
  year={2012},
  publisher={Frontiers}
}

\end{filecontents*}


\usepackage[round]{natbib}
% \addbibresource{bibliography.bib}



\begin{document}


\newcommand{\frontFig}{
\begin{center}
\centering
\normalfont
\large

\begin{tikzpicture}
    \colorlet{redhsb}[hsb]{red}%
    \colorlet{yellowhsb}[hsb]{yellow}%
    \colorlet{orangehsb}[hsb]{orange}%
    \colorlet{whitehsb}[hsb]{white}%
    \shade[left color=white,right color=yellow] (-7,-0.5) rectangle (-5,-1); % 
    \shade[left color=yellow,right color=orange] (-5.02,-0.5) rectangle (-3,-1);
    \shade[left color=orange,right color=red] (-3.02,-0.5) rectangle (-1,-1); % 
    \node (G) at (-4.2,0) {User-defined color gradient};
    \draw (-7,-0.5) -- (-7,-1);\node[inner sep=0] (corr_text) at (-7,-1.3) {0};
    \draw (-5,-0.5) -- (-5,-1);\node[inner sep=0] (corr_text) at (-5,-1.3) {1};
    \draw (-3,-0.5) -- (-3,-1);\node[inner sep=0] (corr_text) at (-3,-1.3) {2};
    \draw (-1,-0.5) -- (-1,-1);\node[inner sep=0] (corr_text) at (-1,-1.3) {3};

    
    
    \node (A) at (-4.2,4) {INPUTS};
\node (A2) at (-4.2,2) {\fontsize{10}{12}\selectfont\begin{tabular}{c | c c c c}
 Biomarkers &  Hippocampus & Inferior & Superior & ...\\
(.csv file) &   & temporal & parietal & ...\\
  \hline
Brain 1 & 0.6 & 2.3 & 1.3 & .. \\
Brain 2 & 1.2 & 0.0 & 3.0 & .. \\
... & \multicolumn{4}{c}{...}\\
\end{tabular}};
 \node (B) at (5,4) {OUTPUTS};
 \node (C) at (5,2) {\includegraphics[height=2.3cm]{images/cortical-front_0.png}
\includegraphics[height=2.3cm]{images/cortical-back_0.png}
\includegraphics[height=2.3cm]{images/subcortical_0.png}
};
 \node (C2) at (C.north) {Brain 1};

    \node (D) at (5,-1) {\includegraphics[height=2.3cm]{images/cortical-front_1.png}
\includegraphics[height=2.3cm]{images/cortical-back_1.png}
\includegraphics[height=2.3cm]{images/subcortical_1.png}};
 \node (D2) at (D.north) {Brain 2};

    \draw[thick,->,shorten >= -2pt] (-2.7,4) -- (3,4) node[midway,above] {BrainPainter};
  \end{tikzpicture}
\captionof{figure}{Given a .csv file with region-of-interest (ROI) biomarkers and a user-defined color gradient, BrainPainter can automatically generate brain images with the cortical surface (left and middle) as well as with subcortical structures (right). The input .csv file can have multiple rows, one for each set of output images. The color gradient is a list of RGB colours given by the user. Final colours are interpolated using the numbers from the input .csv file based on the color gradient -- e.g. if the hippocampus has a value of 1.2, its final color will be an interpolation of colors 1 (yellow) and 2 (orange) from the gradient.}
\label{fig:mainDiag}
\end{center}
\vspace{-3em}
}


\begin{frontmatter}

\title{\textbf{BrainPainter: A software for the visualisation of brain structures, biomarkers and associated pathological processes}}

\ead{razvan@csail.mit.edu}
% \ead[url]{https://github.com/mrazvan22/brain-coloring}

\address[mit]{Computer Science and Artificial Intelligence Laboratory, Massachusetts Institute of Technology, Cambridge, USA, MA 02139}
\address[ucl]{Centre for Medical Image Computing, University College London, Gower Street, London, United Kingdom, WC1E 6BT}
\address[ion]{Queen Square MS Centre, UCL Institute of Neurology, UK
\frontFig
}

\cortext[aaa]{Joint senior authors with equal contribution}


\author[mit,ucl]{R\u{a}zvan V. Marinescu}
\author[ucl,ion]{Arman Eshaghi}
\author[ucl]{Daniel C. Alexander\corref{aaa}}
% \fntext[fn1]{* Joint senior authors}
\author[mit]{Polina Golland\corref{aaa}}
% \fntext[fn2]{*}



\begin{abstract}
We present BrainPainter, a software that automatically generates images of highlighted brain structures given a list of numbers corresponding to the output colours of each region. Compared to existing visualisation software (i.e. Freesurfer, SPM, 3D Slicer), BrainPainter has three key advantages: (1) it does not require the input data to be in a specialised format, allowing BrainPainter to be used in combination with any neuroimaging analysis tools, (2) it can visualise both cortical and subcortical structures and (3) it can be used to generate movies showing dynamic processes, e.g. propagation of pathology on the brain. We highlight three use cases where BrainPainter was used in existing neuroimaging studies: (1) visualisation of the degree of atrophy through interpolation along a user-defined gradient of colours, (2) visualisation of the progression of pathology in Alzheimer's disease as well as (3) visualisation of pathology in subcortical regions in Huntington's disease. Moreover, through the design of BrainPainter we demonstrate the possibility of using a powerful 3D computer graphics engine such as Blender to generate brain visualisations for the neuroscience community. Blender's capabilities, e.g. particle simulations, motion graphics, UV unwrapping, raster graphics editing, raytracing and illumination effects, open a wealth of possibilities for brain visualisation not available in current neuroimaging software. BrainPainter is customisable, easy to use, and can run straight from the web browser: \url{https://brainpainter.csail.mit.edu}, as well as from source-code packaged in a docker container: \url{https://github.com/mrazvan22/brain-coloring}. It can be used to visualise biomarker data from any brain imaging modality, or simply to highlight a particular brain structure for e.g. anatomy courses.

\end{abstract}

% \begin{keyword}
% Brain visualisation \sep
% Neurodegenerative diseases
% \end{keyword}

\end{frontmatter}

%% \linenumbers

%% main text



% \FloatBarrier

% \section*{Abstract}
% % \label{intro}





\section{Introduction}
\label{intro}

% \frontFig

% diagram showing the aim: input numbers and output images

Efficient visualisation of brain structure, function and pathology is crucial for understanding the mechanisms underlying neurodegenerative diseases and eases the interpretation of results in neuroimaging studies. This is especially important in populations studies, where two or more populations are compared for group differences in biomarkers derived from e.g. Magnetic Resonance Imaging, Positron Emission   Tomography (PET) or Computer Tomography (CT). The results are best visualised as brain images, where regions-of-interest (ROIs) are highlighted based on the magnitude of the difference between the two groups. These visualisation are generally done by the same software that performs the registration, segmentation and statistical analysis. However, for traumatic brain injury or less common neurodegenerative diseases such as Parkinson's disease and Multiple Sclerosis, visualisations of statistical results is sometimes not performed due to the inability to register images to a common template or lack of robust registration software. Therefore, many studies such as (\cite{coughlin2015neuroinflammation,schoonheim2012subcortical}) only report differences between patients and controls in tables or as box plots. There is therefore a lack of visualisation tools that can highlight neuroimaging findings for these complex diseases.

When registration to a common population template is possible, e.g. in Alzheimer's disease (AD), excellent 3D visualisation software exists  which allows interactive visualisation of population differences -- e.g. 3D Slicer (\cite{pieper20043d}), Freesurfer (\cite{fischl2012freesurfer}) or SPM (\cite{penny2011statistical}). However, they have several inherent limitations. First, such software -- e.g. Freesurfer -- generally require inputs in their proprietary data format, which is usually difficult and time-consuming to create without using their pipeline. While creating these proprietary data formats is necessary when users need to display voxelwise visualisations, often users only need to highlight entire ROIs -- in this simpler case the user could only provide a list of RGB colors for each ROI in a csv file, removing the need to create input data in a specialised format. Another limitation of existing visualisation software is their difficulty in highlighting complex patterns of pathology in a single slice of a 3D volumetric image. To overcome this, some authors show multiple slices (sometimes up to 8 slices, e.g. \cite{migliaccio2015mapping}), although this takes too much space on the academic paper being published. While Freesurfer solves this problem using a cortical surface-based representation that captures most of the complexity of pathology patterns in a single image, this surface representation is not supported for subcortical structures such as the hippocampus. Third, current visualisation software cannot be easily used to generate e.g. a movie showing a dynamic process, e.g. propagation of pathology within the human brain, as most of them have been intended for interactive visualisation and have no application programming interface (API) that allows automatic generation of hundreds of images using pre-defined settings. 

We present BrainPainter, a software for easy visualisation of structures, pathology and biomarkers in the brain. As opposed to previous visualisation software, the input data is very simple: a generic .csv file containing numbers for each ROI, each number mapping to a different colour to be assigned to that ROI -- such a simple input allows BrainPainter to be used in conjunction with any other neuroimaging analysis software. Secondly, BrainPainter can visualise both cortical and subcortical structures using a surface representation, removing the need to show multiple slices of the same 3D scan. Third, the images are generated automatically from pre-defined view-points, and can be easily used to create a movie showing e.g. the propagation of pathology, without the need to write any extra software code or interface with an API. Written in Python, BrainPainter is open-source and can be extended in many ways. In this paper we describe the capabilities of the software, and showcase three use cases where it was used in neuroimaging studies.


\FloatBarrier
\section{Design}
\label{design}

% diagram showing the Design. what kind of atlases can it take, type of colouring, blender integration

\begin{figure*}[htp]
\centering
 \includegraphics[width=0.8\textwidth]{images/website.png}
 \caption{BrainPainter website interface at \url{http://brainpainter.csail.mit.edu}, showing how it can be easily customised. Here, the user selects the brain type, colours and resolution, and finally uploads the input .csv file with ROI biomarkers. The server then generates the output images, which can be downloaded by the user. More customisation features will be added in future versions.}
  \label{fig:website}
\end{figure*}

% how does BrianPainter work: takes input csv file, generates images. 
BrainPainter has a very simple yet effective workflow. Given an input csv file with biomarkers for each region, it produces high-quality visualisations of cortical and subcortical structures. For this, it uses Blender as a rendering engine, and loads 3D meshes from a template brain (one 3D mesh for each ROI), which are then coloured according to the input numbers. Instead of providing a list of RGB colours for each ROI, we choose a simpler interface of providing one number for each ROI which maps to an RGB color using a user-defined color gradient. For example, the gradient can range from white $\rightarrow$ yellow $\rightarrow$ orange $\rightarrow$ red, as in the example from Fig. \ref{fig:mainDiag}. In this case, the input numbers for each ROI need to be in the range [0,3], where a value of 1.3 would interpolate between colour 1 (yellow) and color 2 (orange).

% use of blender as rednering engine
BrianPainter uses open-source software Blender as the rendering engine. We chose Blender for three reasons. First, it is open-source, allowing us to distribute it already integrated with BrainPainter, thus requiring no further installation. Secondly, Blender is a powerful 3D graphics software, which allowed us to create realistic lightning conditions and handle transparency required for the glass-brain. Third, it also supports creating movies of complex temporal processes such as pathology spread along the brain. The software also supports a variety of object formats for the brain template, including the popular .obj mesh format. As BrainPainter is written in Python, it allows interfacing with any Blender function.

% ATLASES: DK
The software is able to colour and visualise regions belonging to a pre-defined atlas. Currently, we support three widely-used atlases: (i) the Desikan-Killiany (DK) atlas (\cite{desikan2006automated}), (ii) the Destrieux atlas (\cite{destrieux2010automatic}) and (iii) the Tourville atlas (\cite{klein2012101}). However, a custom atlas can also be used by mapping those regions to any of the three atlases currently supported, through the modification a simple mapping in the main configuration file. \footnote{\url{https://github.com/mrazvan22/brain-coloring/blob/master/config.py}}





\section{Customisation}
\label{customisation}

% customisation

BrainPainter can be easily customised in several ways, as shown in Fig \ref{fig:website}. First of all, the colours assigned to each region can be changed by modifying both the control points of the color gradient and the input numbers selecting colors along the gradient. The background colour and image resolution can also be changed.  

The 3D structures being visualised can also be customised. We currently support three atlases (Desikan-Killiany, Destrieux and Tourville) as well as two types of brain surfaces: inflated, which is a brain surface that is smoothed out and where no gyri appear, and also pial, the standard brain surface with gyri. The software allows one to remove some 3D structures -- for example, Fig. \ref{fig:peter} shows the subcortical structures with the cerebellum removed from the visualisation -- contrast this with Fig. \ref{fig:youngProg}. 
 
BrainPainter also support two types of surfaces, cortical and subcortical structures. For the cortical surface, we only show the left hemisphere (although the right hemisphere can also be added), and provide two default viewing angles (front and back). For the subcortical structures, we show them for both hemispheres and also show the right hemisphere as a glass brain, for reference.

More complex settings such as the viewing angle and luminosity can also be customised, but currently require minor modifications to the source code. In the future, we plan to enable these customisations from the main configuration file.




\begin{figure}
 \includegraphics[width=0.49\textwidth]{images/young_3brains.png}
 \caption{Demonstration of BrainPainter for showing extent of pathology on a vertical bar, where colours towards blue show increased severity. Source: \cite{young2018uncovering}.}
 \label{fig:youngDegree}
\end{figure}

\begin{figure*}[htp]
\centering
 \includegraphics[width=0.8\textwidth, trim=20 0 0 220, clip]{images/young_progression.png}
 \caption{Demonstration of our software for showing the temporal progression of pathology, as a sequence of snapshot at different stages. Images used by
 \cite{young2018uncovering}.}
  \label{fig:youngProg}
\end{figure*}



\section{First use case: Visualising the degree of pathology}
\label{degree}

In the first use case, we want to visualise the degree of pathology in Alzheimer's disease. During the progression of Alzheimer's disease, some regions of the brain such as the hippocampus and temporal lobes will be more affected compared to other regions of the brain such as the occipital lobe. Visualisation of pathology in AD is important in order to understand its underlying mechanisms and generate new hypotheses. 

The notion of pathology here is abstract, and can refer to atrophy as measured by volume loss or cortical thinning, white matter degradation as measured by diffusion tensor imaging (DTI) changes in fractional anisotropy (FA), or the level of abnormal conformations of proteins such as amyloid-beta or tau as measured by Positron Emission Tomography. However, BrainPainter is agnostic to the meaning of these biomarkers and can be used with any imaging modality, including markers derived from several modalities together. 

Fig. \ref{fig:youngDegree} shows an application of BrainPainter by (\cite{young2018uncovering}) to highlight the degree of atrophy in Alzheimer's disease. Regions with no atrophy are coloured in white, while regions with severe atrophy are coloured in blue. The gradient on the right shows, for every color, the number of standard deviations away from controls.


\section{Second use case: Visualising the temporal progression of neurodegenerative diseases}
\label{progression2}

In the second use case, we would like to visualise the temporal progression of Alzheimer's disease (AD). Alzheimer's disease is characterised by a slow, continuous progression -- while it's mechanisms are still not fully understood, it is currently believed that initial abnormalities in the amyloid and tau proteins cause a cascade of events that eventually lead to axonal degradation, neural death and cognitive decline (\cite{mudher2002alzheimer}). Therefore, being able to visualise the progression of these events, including their timing and speed, is crucial for understanding the mechanisms of Alzheimer's disease. 


Fig. \ref{fig:youngProg}, reproduced and adapted from \cite{young2018uncovering}, demonstrates the ability of BrainPainter to visualise the evolution of atrophy in two subtypes of Alzheimer's disease -- \emph{cortical} and \emph{subcortical} -- characterised by prominent atrophy in the cortical and subcortical regions respectively. This study done by \cite{young2018uncovering} used data from the Alzheimer's disease Neuroimaging Initiative to disentangle the heterogeneity of AD into subtypes with different progression. Here, visualisations provided by BrainPainter were able to characterise not only the degree of atrophy in each region (white/red to blue colors), but also the timing of atrophy events. For example, even in the \emph{cortical} subtype, the hippocampus becomes affected by stage 13, while similarly, in the \emph{subcortical} subtype the temporal lobe becomes affected by stage 13. 


\section{Third use case: Visualising pathology in subcortical structures}
\label{progression3}

The ability to visualise subcortical structures is crucial for neurodegenerative diseases that cause damage to these regions. Apart from Alzheimer's disease, Huntington's disease (HD) is also known for targetting subcortical regions (\cite{douaud2009vivo,wijeratne2018image}). The neurodegeneration in HD is believed to begin in the striatum and pallidum, and later followed by other subcortical and cortical regions (\cite{douaud2009vivo}).

Fig. \ref{fig:peter}, reproduced and adapted with permission from \cite{wijeratne2018image}, shows visualisations generated by BrainPainter of atrophy progression in subcortical areas, for Huntington's disease. The images show early involvement of the putamen, caudate and pallidum in the progression of Huntington's disease, and demonstrate the potential of BrainPainter in visualising pathology dynamics in subcortical regions using parsimonious glass-brain images.


\begin{figure}[htp]
\centering
% \subfigure{Stage 0\includegraphics[width=0.2\textwidth]{images/ebmhd_pngs/subcortical_stage0.png}}
\subfloat[Stage 0]{
\includegraphics[width=0.2\textwidth,trim=70 0 70 0, clip]{images/ebmhd_pngs/subcortical_stage0.png}}
\subfloat[Stage 3]{
\includegraphics[width=0.2\textwidth,trim=70 0 70 0, clip]{images/ebmhd_pngs/subcortical_stage3.png}}

\subfloat[Stage 7]{
\includegraphics[width=0.2\textwidth,trim=70 0 70 0, clip]{images/ebmhd_pngs/subcortical_stage7.png}}
\subfloat[Stage 10]{
\includegraphics[width=0.2\textwidth,trim=70 0 70 0, clip]{images/ebmhd_pngs/subcortical_stage10.png}}
 \caption{Progression of pathology in subcortical regions within a glass brain, using images generated with our method. Images used by  
 \cite{wijeratne2018image}.}
   \label{fig:peter}
\end{figure}



\section{Conclusion}

We presented BrainPainter, an open-source software that can be used to visualise structures, biomarkers and pathologies in the human brain. The visualisations generated by BrainPainter can be used to significantly enhance the interpretation of neuroimaging research and can be easily embedded by researchers into scientific articles. While not demonstrated here, BrainPainter can also easily generate movies showing dynamic processes, e.g. propagation of brain pathology. 

Our software has several limitations that can be addressed in future versions. First, it can currently only highlight entire regions-of-interest from an atlas. However, this was a design choice, as it removes the need for users to create specialised input files with voxelwise measurements, thus increasing usability. Nevertheless, in future versions we might add the ability to highlight fine-grained patterns of pathology. Yet another limitation of BrainPainter is that it cannot visualise more complex structures such as white-matter tracts, although we plan to add such functionality in future releases. 

The use of the powerful Blender engine opens numerous avenues not possible with current neuroimaging software: motion graphics can be used to generate realistic movies showing e.g. the evolution of biomarkers, particle simulations can be used to visualise toxic proteins accumulating in certain regions, soft-body simulations can be used to model brain deformations due to head trauma, while camera-based rendering allows the creation of educational videos. 

\FloatBarrier
\section{Acknowledgements}


RVM was supported by the NIH grants NIBIB NAC P41EB015902 and NINDS R01NS086905, as well as the EPSRC Centre For Doctoral Training in Medical Imaging with grant EP/L016478/1. AE received a McDonald Fellowship from the Multiple Sclerosis International Federation (MSIF, www.msif.org), and the ECTRIMS -- MAGNIMS Fellowship. DCA was supported by EuroPOND, which is an EU Horizon 2020 project, and by EPSRC grants J020990, M006093 and M020533. PG was supported by NIH grants NIBIB NAC P41EB015902 and NINDS R01NS086905. 

We are also particularly grateful to Anderson Winkler for creating the 3D brain templates for all three atlases, which are used in this work.\footnote{https://brainder.org/research/brain-for-blender/}








\section{References}

\bibliographystyle{plainnat}
\bibliography{bibliography}




\end{document}




\endinput


%%
%% End of file `elsarticle-template-harv.tex'.
